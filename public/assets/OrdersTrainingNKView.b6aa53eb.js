import{_ as L,a as Q,r as g,B as V,o as B,br as I,$ as k,g as c,d as u,e as n,f as s,j as N,w as l,O as v,i as S,ar as f,Q as j,W as x,X as h,bs as E,as as R,at as H,au as K,u as z,Z as G,Y as W}from"./index.e6e69252.js";import{Q as M}from"./ClosePopup.b4b1291c.js";import{A as X,Q as p,a as Y}from"./AppModal.f267bacf.js";import{Q as C,a as Z}from"./QFab.a380635d.js";import"./use-checkbox.0aec5f55.js";import"./QCard.a2e19497.js";const J=[{name:"name",required:!0,label:"\u0424\u0418\u041E",align:"left",field:o=>o.listener.firstName+" "+o.listener.secondName[0]+". "+o.listener.lastName[0]+".",format:o=>`${o}`,sortable:!0},{name:"date",align:"left",label:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",field:"date",sortable:!0},{name:"companyShortName",align:"left",label:"\u041F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435",field:"companyShortName",sortable:!0},{name:"contract",align:"left",label:"\u0414\u043E\u0433\u043E\u0432\u043E\u0440",field:"contractNumber",sortable:!1},{name:"program",align:"left",label:"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430",field:"program",sortable:!0},{name:"status",align:"left",label:"\u0421\u0442\u0430\u0442\u0443\u0441",field:"status",sortable:!0},{name:"control",align:"center",label:"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",field:""}],$=[{name:"name",required:!0,label:"\u0424\u0418\u041E",align:"left",field:o=>o.listener.firstName+" "+o.listener.secondName+" "+o.listener.lastName,format:o=>`${o}`,sortable:!0},{name:"date",align:"left",label:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",field:"date",sortable:!0},{name:"program",align:"left",label:"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430",field:"program",sortable:!0},{name:"status",align:"left",label:"\u0421\u0442\u0430\u0442\u0443\u0441",field:"status",sortable:!0},{name:"control",align:"center",label:"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",field:""}],ee={components:{AppModal:X},setup(){const o=Q(),t=g(!1),r=o.getters["auth/user"],e=g(""),q=V(()=>o.getters["orderTraining/orders"]),_=g([]),y=V(()=>o.getters["orderTraining/orders"].filter(i=>e.value?(i.listener.firstName+" "+i.listener.secondName+" "+i.listener.lastName).toLowerCase().includes(e.value.toLowerCase()):!0)),a=g(!1),m=g(""),w=g("");B(()=>{r.roles&&(r.roles.includes("admin")||r.roles.includes("god")?t.value=!0:t.value=!1)});async function A(){r.roles&&(r.roles.includes("admin")||r.roles.includes("god")?await o.dispatch("orderTraining/load"):await o.dispatch("orderTraining/loadByCompany",r.company))}function D(i,d){a.value=!0,i=="delete"?(m.value="delete",w.value="\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0438"):i=="send"&&(m.value="send",w.value="\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443")}function T(){a.value=!1,m.value="",w.value=""}async function F(i){try{await i.forEach(d=>{const P=d._id,U={type:d.orderType,program:d.program,status:"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443",date:new Date,listener:d.listener,company:d.company,ownerCompany:d.ownerCompany,ownerListener:d.ownerListener};o.dispatch("orderTraining/update",{value:U,id:P})})}catch{}T(),A(),_.value=[]}async function O(i){console.log(i);try{await i.forEach(d=>{o.dispatch("orderTraining/remove",d._id)})}catch{}T(),A(),_.value=[]}return{initialPagination:{sortBy:"status",descending:!0,page:1,rowsPerPage:10},user:r,access:t,columnsAdmin:J,columnsUser:$,rows:q,filteredRows:y,selected:_,search:e,getSelectedString(){return _.value.length===0?"":`${_.value.length} record${_.value.length>1?"s":""} selected of ${y.value.length}`},modal:a,modalType:m,modalTitle:w,showModal:D,closeModal:T,sendForVerification:F,remove:O,dateFormat:I}}},b=o=>(H("data-v-12251dfc"),o=o(),K(),o),ae={key:0},oe=b(()=>n("p",{class:"text-center"}," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u043E\u043D\u043D\u0430\u044F \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0430 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u044F \u043D\u0435 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0430! ",-1)),te={class:"text-center"},ne={key:1},se=b(()=>n("p",{class:"text-center"},"\u0417\u0430\u044F\u0432\u043E\u043A \u043D\u0430 \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u0435 \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438 \u041D\u041A \u043D\u0435\u0442",-1)),le={class:"text-center"},re={key:2},ce={class:""},de={class:"text-responsive"},ie={class:"text-responsive"},me={class:"table-nav"},ue={key:0,class:"q-card__section q-card__section--vert"},_e={key:1,class:"q-card__section q-card__section--vert"},be={class:"q-card__actions justify-end q-card__actions--horiz row"},ge=b(()=>n("span",{class:"q-focus-helper"},null,-1)),ye=b(()=>n("span",{class:"q-btn__content text-center col items-center q-anchor--skip justify-center row"},[n("span",{class:"block"},"\u0423\u0434\u0430\u043B\u0438\u0442\u044C")],-1)),fe=[ge,ye],pe=b(()=>n("span",{class:"q-focus-helper"},null,-1)),he=b(()=>n("span",{class:"q-btn__content text-center col items-center q-anchor--skip justify-center row"},[n("span",{class:"block"},"\u0414\u0430")],-1)),ve=[pe,he],we=b(()=>n("span",{class:"q-focus-helper"},null,-1)),ke=b(()=>n("span",{class:"q-btn__content text-center col items-center q-anchor--skip justify-center row"},[n("span",{class:"block"},"\u041E\u0442\u043C\u0435\u043D\u0430")],-1)),qe=[we,ke];function Te(o,t,r,e,q,_){const y=k("app-modal");return c(),u("div",null,[!e.access&&(!e.user.id||!e.user.firstName||!e.user.secondName||!e.user.lastName||!e.user.phone||!e.user.email||!e.user.post||!e.user.companyBank||!e.user.companyBik||!e.user.companyDirFirstName||!e.user.companyDirLastName||!e.user.companyDirPost||!e.user.companyDirSecondName||!e.user.companyEmail||!e.user.companyFullName||!e.user.companyGrounds||!e.user.companyInn||!e.user.companyLegalAddressCity||!e.user.companyLegalAddressCode||!e.user.companyLegalAddressHouse||!e.user.companyLegalAddressRoom||!e.user.companyLegalAddressStreet||!e.user.companyLegalAddressTownship||!e.user.companyMailAddressCity||!e.user.companyMailAddressCode||!e.user.companyMailAddressHouse||!e.user.companyMailAddressRoom||!e.user.companyMailAddressStreet||!e.user.companyMailAddressTownship||!e.user.companyOkpo||!e.user.companyOwnershipType||!e.user.companyPayment||!e.user.companyPhone||!e.user.companyShortName)?(c(),u("div",ae,[oe,n("div",te,[s(N,{label:"\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u044C",type:"button",color:"primary",to:"/profile"})])])):e.rows.length?(c(),u("div",re,[n("div",ce,[s(j,{"bottom-slots":"",modelValue:e.search,"onUpdate:modelValue":t[1]||(t[1]=a=>e.search=a),label:"\u0414\u043B\u044F \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u0446\u0438\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0424\u0418\u041E"},{append:l(()=>[e.search!==""?(c(),v(S,{key:0,name:"close",onClick:t[0]||(t[0]=a=>e.search=""),class:"cursor-pointer"})):f("",!0),s(S,{name:"search"})]),_:1},8,["modelValue"])]),s(Y,{rows:e.filteredRows,columns:e.access?e.columnsAdmin:e.columnsUser,"row-key":"_id","selected-rows-label":e.getSelectedString,selection:"multiple",pagination:e.initialPagination,"hide-selected-banner":!0,selected:e.selected,"onUpdate:selected":t[2]||(t[2]=a=>e.selected=a)},{"header-selection":l(a=>[s(M,{modelValue:a.selected,"onUpdate:modelValue":m=>a.selected=m},null,8,["modelValue","onUpdate:modelValue"])]),"body-selection":l(a=>[s(M,{modelValue:a.selected,"onUpdate:modelValue":m=>a.selected=m},null,8,["modelValue","onUpdate:modelValue"])]),"body-cell-date":l(a=>[s(p,{props:a},{default:l(()=>[x(h(a.row.status=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435"?e.dateFormat(a.row.date):"\u041D\u0435 \u0437\u0430\u0434\u0430\u043D\u0430"),1)]),_:2},1032,["props"])]),"body-cell-companyShortName":l(a=>[s(p,{props:a},{default:l(()=>[n("div",de,h(a.row.user.companyShortName),1)]),_:2},1032,["props"])]),"body-cell-contract":l(a=>[s(p,{props:a},{default:l(()=>[x(h(a.row.contractNumber&&a.row.contractDate?a.row.contractNumber+" \u043E\u0442 "+e.dateFormat(a.row.contractDate):"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E"),1)]),_:2},1032,["props"])]),"body-cell-program":l(a=>[s(p,{props:a},{default:l(()=>[n("div",ie,h(a.row.program=="vik"?"\u0412\u0418\u041A":a.row.program=="vd"?"\u0412\u0414":a.row.program=="tk"?"\u0422\u041A":a.row.program=="pvk"?"\u041F\u0412\u041A":a.row.program=="pvt"?"\u041F\u0412\u0422":a.row.program=="mk"?"\u041C\u041A":a.row.program=="uk"?"\u0423\u041A":a.row.program=="rk"?"\u0420\u041A":a.row.program=="mi"?"\u041C\u0418":a.row.program=="1s"?"1\u0421":""),1)]),_:2},1032,["props"])]),"body-cell-status":l(a=>[s(p,{props:a},{default:l(()=>[s(E,{color:a.row.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?"primary":a.row.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"?"orange":a.row.status=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"?"purple":a.row.status=="\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430"?"green":a.row.status=="\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430"?"red":a.row.status=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435"?"teal":a.row.status=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"?"grey":""},{default:l(()=>[x(h(a.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-control":l(a=>[s(p,{props:a},{default:l(()=>[n("div",null,[s(N,{class:"bg-primary text-white q-mr-sm",icon:"open_in_new",to:{name:"orderTrainingNK",params:{id:a.row._id}}},null,8,["to"])])]),_:2},1032,["props"])]),_:1},8,["rows","columns","selected-rows-label","pagination","selected"]),n("div",me,[s(Z,{color:"secondary",icon:"more_vert",direction:"up"},{default:l(()=>[s(C,{color:"amber","text-color":"black",icon:"delete",disable:!e.selected.length||e.selected.map(a=>a.status).includes("\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")&&!e.access||e.selected.map(a=>a.status).includes("\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443")&&!e.access||e.selected.map(a=>a.status).includes("\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")&&!e.access||e.selected.map(a=>a.status).includes("\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430")&&!e.access||e.selected.map(a=>a.status).includes("\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430")&&!e.access,onClick:t[3]||(t[3]=a=>e.showModal("delete"))},null,8,["disable"]),e.access?f("",!0):(c(),v(C,{key:0,color:"amber","text-color":"black",disable:!e.selected.length||e.selected.map(a=>a.status).includes("\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")||e.selected.map(a=>a.status).includes("\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443")||e.selected.map(a=>a.status).includes("\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")||e.selected.map(a=>a.status).includes("\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430")||e.selected.map(a=>a.status).includes("\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430"),onClick:t[4]||(t[4]=a=>e.showModal("send")),icon:"send_and_archive"},null,8,["disable"])),s(C,{color:"amber","text-color":"black",icon:"note_add",to:"/add-order-training-nk"})]),_:1})])])):(c(),u("div",ne,[se,n("div",le,[s(N,{label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",type:"button",color:"primary",to:"/add-order-training-nk"})])])),(c(),v(R,{to:"body"},[s(y,{title:e.modalTitle,show:e.modal,onClose:e.closeModal},{default:l(()=>[e.modalType=="delete"?(c(),u("div",ue," \u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B. \u0412\u044B \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435? ")):f("",!0),e.modalType=="send"?(c(),u("div",_e," \u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443? ")):f("",!0),n("div",be,[e.modalType=="delete"?(c(),u("button",{key:0,class:"q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-negative q-btn--actionable q-focusable q-hoverable",tabindex:"0",type:"button",onClick:t[5]||(t[5]=a=>e.remove(e.selected))},fe)):f("",!0),e.modalType=="send"?(c(),u("button",{key:1,class:"q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-primary q-btn--actionable q-focusable q-hoverable",tabindex:"0",type:"button",onClick:t[6]||(t[6]=a=>e.sendForVerification(e.selected))},ve)):f("",!0),n("button",{class:"q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-positive q-btn--actionable q-focusable q-hoverable",tabindex:"0",type:"button",onClick:t[7]||(t[7]=(...a)=>e.closeModal&&e.closeModal(...a))},qe)])]),_:1},8,["title","show","onClose"])]))])}var Ne=L(ee,[["render",Te],["__scopeId","data-v-12251dfc"]]);const xe={title:"\u041F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u0435 \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438 \u041D\u041A",titleTemplate:o=>`${o} | \u0423\u043D\u0438\u0432\u0435\u0440\u0441\u0438\u0442\u0435\u0442\u0441\u043A\u0438\u0435 \u0442\u0435\u0445\u043D\u043E\u043B\u043E\u0433\u0438\u0438`},Ce={setup(){z(xe);const o=g(!1),t=Q();t.getters["orderTraining/orders"];const r=t.getters["auth/user"];return B(async()=>{o.value=!0,r.roles.length&&(r.roles.includes("admin")||r.roles.includes("god")?await t.dispatch("orderTraining/load"):await t.dispatch("orderTraining/loadByCompany",r.id)),o.value=!1}),{loading:o}},components:{AppLoader:G,AppPage:W,OrdersTrainingTable:Ne}},Ae={key:0};function Ve(o,t,r,e,q,_){const y=k("AppLoader"),a=k("OrdersTrainingTable"),m=k("app-page");return c(),v(m,{title:"\u0417\u0430\u044F\u0432\u043A\u0438 \u043D\u0430 \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u0435 \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438 \u041D\u041A"},{default:l(()=>[n("div",null,[e.loading?(c(),u("div",Ae,[s(y)])):(c(),v(a,{key:1}))])]),_:1})}var Fe=L(Ce,[["render",Ve]]);export{Fe as default};
