import{b as P,C as be}from"./ClosePopup.b4b1291c.js";import{_ as ke,r as y,a as Ne,c as Se,B as x,br as G,o as Me,D as Le,$ as j,g as i,d as O,f as d,w as m,e as h,ar as g,Q as R,i as Ce,aI as Te,j as w,T as K,aU as Ve,aV as Ue,U as Z,V as te,W as q,X as oe,O as v,h as F,as as _e}from"./index.e6e69252.js";import{L as Oe,Q as Re,a as Fe}from"./ListenersForm.aa490764.js";import{u as Ae,a as A,e as re,c as W,Q as Ie}from"./array.2e3cbb14.js";import{A as Pe}from"./AppModal.f267bacf.js";import{U as xe}from"./UsersForm.a908d082.js";function le(e){return{email:e.email,id:e._id,firstName:e.firstName,secondName:e.secondName,lastName:e.lastName,post:e.post,phone:e.phone,companyFullName:e.companyFullName,companyShortName:e.companyShortName,companyOwnershipType:e.companyOwnershipType,companyOwnershipTypeOptions:e.companyOwnershipTypeOptions,companyLegalAddressCode:e.companyLegalAddressCode,companyLegalAddressCity:e.companyLegalAddressCity,companyLegalAddressTownship:e.companyLegalAddressTownship,companyLegalAddressStreet:e.companyLegalAddressStreet,companyLegalAddressHouse:e.companyLegalAddressHouse,companyLegalAddressRoom:e.companyLegalAddressRoom,companyMailAddressCode:e.companyMailAddressCode,companyMailAddressCity:e.companyMailAddressCity,companyMailAddressTownship:e.companyMailAddressTownship,companyMailAddressStreet:e.companyMailAddressStreet,companyMailAddressHouse:e.companyMailAddressHouse,companyMailAddressRoom:e.companyMailAddressRoom,companyPhone:e.companyPhone,companyEmail:e.companyEmail,companyBank:e.companyBank,companyPayment:e.companyPayment,companyInn:e.companyInn,companyOkpo:e.companyOkpo,companyBik:e.companyBik,companyDirFirstName:e.companyDirFirstName,companyDirSecondName:e.companyDirSecondName,companyDirLastName:e.companyDirLastName,companyDirPost:e.companyDirPost,companyGrounds:e.companyGrounds}}function qe(e){return{id:e._id,status:e.status,numberNk:e.numberNk,numberRi:e.numberRi,firstName:e.firstName,secondName:e.secondName,lastName:e.lastName,gender:e.gender,snils:e.snils,post:e.post,birthday:e.birthday,passportSeries:e.passportSeries,passportNumber:e.passportNumber,passportIssued:e.passportIssued,passportDate:e.passportDate,passportCode:e.passportCode,mailCode:e.mailCode,city:e.city,township:e.township,street:e.street,homeNumber:e.homeNumber,apartment:e.apartment,phone:e.phone,email:e.email,education:e.education,institution:e.institution,specialization:e.specialization,diplomSeries:e.diplomSeries,diplomNumber:e.diplomNumber,diplomDate:e.diplomDate,weldingMethodDateRde:e.weldingMethodDateRde,weldingMethodDateSp:e.weldingMethodDateSp,weldingMethodDateSf:e.weldingMethodDateSf,weldingMethodDateMig:e.weldingMethodDateMig,weldingMethodDateMag:e.weldingMethodDateMag,weldingMethodDatePag:e.weldingMethodDatePag,weldingMethodDatePig:e.weldingMethodDatePig,weldingMethodDateVig:e.weldingMethodDateVig,weldingMethodDatePs:e.weldingMethodDatePs,weldingMethodDateGs:e.weldingMethodDateGs,weldingMethodDateNi:e.weldingMethodDateNi,weldingMethodDateZn:e.weldingMethodDateZn,weldingMethodDateNg:e.weldingMethodDateNg,weldingMethodDateE:e.weldingMethodDateE,methodNkDateVik:e.methodNkDateVik,methodNkDateVd:e.methodNkDateVd,methodNkDateTk:e.methodNkDateTk,methodNkDatePvk:e.methodNkDatePvk,methodNkDatePvt:e.methodNkDatePvt,methodNkDateMk:e.methodNkDateMk,methodNkDateUk:e.methodNkDateUk,methodNkDateRk:e.methodNkDateRk,methodNkDateMi:e.methodNkDateMi,methodNkDate1s:e.methodNkDate1s,typeRiDateMsi:e.typeRiDateMsi,typeRiDateMdi:e.typeRiDateMdi,typeRiDateIt:e.typeRiDateIt,typeRiDateIks:e.typeRiDateIks,typeRiDateTi:e.typeRiDateTi,typeRiDateIsm:e.typeRiDateIsm,typeRiDateSe:e.typeRiDateSe,typeRiDateSvi:e.typeRiDateSvi,weldingProductionDate:e.weldingProductionDate,pkInfo:e.pkInfo,attNkInfo:e.attNkInfo,attRiInfo:e.attRiInfo,ownerUser:e.ownerUser}}const Ee={components:{AppModal:Pe,ListenersForm:Oe,UsersForm:xe},props:{orderType:{type:String,required:!0},orderData:{type:Object,required:!1}},emits:["updateSuccess","hide"],setup(e,{emit:o}){const r=y(!1),a=Ne(),M=Se(),{handleSubmit:I}=Ae(),u=a.getters["auth/user"],c=y(!1),U=x(()=>{var t;return(t=D.value)!=null&&t.value?c.value?le(a.getters["auth/users"].filter(s=>s._id==D.value.value)[0]):le({...u,_id:u.id}):null}),L=x(()=>{var t;return(t=S.value)!=null&&t.value?qe(a.getters["listener/listeners"].filter(s=>s._id==S.value.value)[0]):null}),n=y(!1),C=y(""),T=y(""),_=x(()=>a.getters["auth/users"].map(t=>({value:t._id,description:t.companyShortName,label:t.companyFullName}))),E=y(_.value),B=y(),Q=y(),X=y(),J=y(),b=y(""),k=y(""),N=y(""),p=y("\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"),V=x(()=>a.getters["listener/listeners"].map(t=>({value:t._id,label:t.firstName+" "+t.secondName+" "+t.lastName+" ("+G(t.birthday)+")"}))),H=y(V.value),Y=y(0);Me(async()=>{r.value=!0,u.roles.length&&(u.roles.includes("admin")||u.roles.includes("god")?(c.value=!0,await a.dispatch("auth/loadUsers")):c.value=!1),e.orderData?(c.value?D.value=_.value.map(t=>t).filter(t=>t.value==e.orderData.ownerUser)[0]:(D.value={value:u.id,description:u.companyShortName,label:u.companyFullName},S.value=V.value.map(t=>t).filter(t=>t.value==e.orderData.ownerListener)[0]),$.value=e.orderData.program,p.value=e.orderData.status,b.value=e.orderData.commentUser,k.value=e.orderData.commentListener,N.value=e.orderData.commentOrder,ee.value=e.orderData.contractNumber,ae.value=e.orderData.contractDate):D.value={value:u.id,description:u.companyShortName,label:u.companyFullName},r.value=!1});const{value:D,errorMessage:ne}=A("usersSelect",re().required("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0443\u043A\u0430\u0436\u0438\u0442\u0435 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435").nullable()),{value:S,errorMessage:se}=A("listenersSelect",re().required("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044F").nullable()),{value:$,errorMessage:de}=A("program",W().required("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u043E\u0444\u0435\u0441\u0441\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u043E\u0439 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u044F \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438")),{value:ee,errorMessage:ie}=A("contractNumber",W().trim()),{value:ae,errorMessage:ce}=A("contractDate",W().trim());Le(D,async(t,s)=>{t!==""&&t!==null?await a.dispatch("listener/loadByCompany",t.value):a.commit("listener/setListeners",[]),e.orderData&&(Y.value+=1),t!==s&&(Y.value==1&&e.orderData?S.value=V.value.map(l=>l).filter(l=>l.value==e.orderData.ownerListener)[0]:S.value=void 0)});function me(t,s){s(()=>{if(t===""){s(()=>{E.value=_.value});return}else{const l=t.toLowerCase();E.value=_.value.filter(f=>f.label.toLowerCase().indexOf(l)>-1||f.description.toLowerCase().indexOf(l)>-1)}})}function ue(t,s,l){s(()=>{if(t===""){s(()=>{H.value=V.value});return}else{const f=t.toLowerCase();H.value=V.value.filter(we=>we.label.toLowerCase().indexOf(f)>-1)}})}function pe(){}const ye=async t=>{if(B.value.hidePopup(),B.value.updateInputValue("",!0),c.value&&(Q.value.hidePopup(),Q.value.updateInputValue("",!0)),n.value=!0,t=="addListener")C.value="addListener",T.value="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u043E\u0433\u043E \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044F";else if(t=="editListener"){C.value="editListener",T.value="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044F";try{r.value=!0,X.value=await a.dispatch("listener/loadById",S.value.value),r.value=!1}catch{r.value=!1}}else if(t=="addCompany")C.value="addCompany",T.value="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u043E\u0435 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435";else if(t=="editCompany"){C.value="editCompany",T.value="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u044F";try{r.value=!0,await a.dispatch("settingsConfigurable/load","ownership-type"),J.value=await a.dispatch("auth/loadUserById",D.value.value),r.value=!1}catch{r.value=!1}}},z=()=>{n.value=!1,C.value="",T.value=""},ve=async t=>{u.roles&&(u.roles.includes("admin")||u.roles.includes("god")?D.value?await a.dispatch("listener/loadByCompany",D.value.value):a.commit("listener/setListeners",[]):await a.dispatch("listener/loadByCompany",u.id)),z();const s=V.value.map(l=>l).filter(l=>t.id?l.value==t.id:l.label==t.firstName+" "+t.secondName+" "+t.lastName+" ("+G(t.birthday)+")")[0];S.value=s},ge=async t=>{await a.dispatch("auth/loadUsers"),z();const s=_.value.map(l=>l).filter(l=>t.id?l.value==t.id:l.label==t.fullName)[0];D.value=s},De=I(async t=>{try{await a.dispatch("orderTraining/create",{type:e.orderType,program:t.program,status:p.value,commentUser:b.value,commentListener:k.value,commentOrder:N.value,contractNumber:t.contractNumber,contractDate:t.contractDate,listener:L.value,user:U.value,ownerListener:t.listenersSelect.value,ownerUser:t.usersSelect.value}),M.push("/orders-training-nk")}catch{}}),fe=I(async t=>{const s=e.orderData._id,l={type:e.orderType,program:t.program,status:p.value,number:"",commentUser:b.value,commentListener:k.value,commentOrder:N.value,contractNumber:t.contractNumber,contractDate:t.contractDate,date:new Date,listener:L.value,user:U.value,ownerListener:t.listenersSelect.value,ownerUser:t.usersSelect.value};try{if(c.value&&p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&!b.value&&!k.value&&!N.value)a.dispatch("setMessage",{value:"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0445\u043E\u0442\u044F \u0431\u044B \u043E\u0434\u0438\u043D \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",type:"danger"});else if(c.value&&p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&(b.value||k.value||N.value))await a.dispatch("orderTraining/update",{value:l,id:s}),M.push("/orders-training-nk");else if(c.value&&p.value=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435"&&(b.value||k.value||N.value))a.dispatch("setMessage",{value:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u043D\u0430\u0447\u0430\u0442\u044C \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435, \u043D\u0435 \u0443\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u044B \u0432\u0441\u0435 \u0437\u0430\u043C\u0435\u0447\u0430\u043D\u0438\u044F",type:"danger"});else if(c.value&&p.value=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")l.commentUser="",l.commentListener="",l.commentOrder="",await a.dispatch("orderTraining/update",{value:l,id:s}),o("updateSuccess");else if(c.value&&p.value=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")if(e.orderData.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"){await a.dispatch("orderTrainingNumbering/load");const f=a.getters["orderTrainingNumbering/ordersNumbering"][0];l.number=f.prefix+f.num,l.date=new Date,await a.dispatch("orderTraining/update",{value:l,id:s}),await a.dispatch("orderTrainingNumbering/update",{prefix:f.prefix,num:+f.num+1,id:f._id}),o("updateSuccess")}else a.dispatch("setMessage",{value:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u043D\u0430\u0447\u0430\u0442\u044C \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435, \u0437\u0430\u044F\u0432\u043A\u0430 \u0435\u0449\u0435 \u043D\u0435 \u0431\u044B\u043B\u0430 \u043F\u0440\u0438\u043D\u044F\u0442\u0430",type:"danger"});else!c.value&&p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"?(await a.dispatch("orderTraining/update",{value:l,id:s}),M.push("/orders-training-nk")):!c.value&&p.value=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?(l.status="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A",await a.dispatch("orderTraining/update",{value:l,id:s}),M.push("/orders-training-nk")):c.value&&p.value=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"?(l.commentUser="",l.commentListener="",l.commentOrder="",await a.dispatch("orderTraining/update",{value:l,id:s}),M.push("/orders-training-nk")):!c.value&&p.value=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||c.value&&(p.value=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"||p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"||p.value=="\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430")?(await a.dispatch("orderTraining/update",{value:l,id:s}),M.push("/orders-training-nk")):(await a.dispatch("orderTraining/update",{value:l,id:s}),o("updateSuccess"))}catch{}}),he=I(async t=>{try{const s=e.orderData._id,l={type:e.orderType,program:t.program,status:p.value,number:"",commentUser:b.value,commentListener:k.value,commentOrder:N.value,contractNumber:t.contractNumber,contractDate:t.contractDate,date:new Date,listener:L.value,user:U.value,ownerListener:t.listenersSelect.value,ownerUser:t.usersSelect.value};await a.dispatch("orderTraining/update",{value:l,id:s}),o("updateSuccess")}catch{}});return{access:c,loading:r,modal:n,modalType:C,modalTitle:T,currentListener:X,currentCompany:J,showModal:ye,closeModal:z,onSubmit:De,update:fe,updateListeners:ve,updateUsers:ge,sendForVerification:he,dateFormat:G,usersSelectOptions:E,usersSelectFilterFn:me,usersSelect:D,usersSelectError:ne,listenersSelect:S,listenersSelectError:se,contractNumber:ee,contractDate:ae,cNumberError:ie,cDateError:ce,commentUser:b,commentListener:k,commentOrder:N,filterFn:ue,abortFilterFn:pe,program:$,programError:de,status:p,listenerOptions:H,listenerSelectRef:B,usersSelectRef:Q,programOptionsNK:[{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0412\u0438\u0437\u0443\u0430\u043B\u044C\u043D\u044B\u0439 \u0438 \u0438\u0437\u043C\u0435\u0440\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0412\u0418\u041A)",value:"vik"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u044F \xAB\u0412\u0438\u0431\u0440\u043E\u0434\u0438\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0412\u0414)",value:"vd"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u044F \xAB\u0422\u0435\u043F\u043B\u043E\u0432\u043E\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0422\u041A)",value:"tk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u041A\u0430\u043F\u0438\u043B\u043B\u044F\u0440\u043D\u044B\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u041F\u0412\u041A)",value:"pvk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0422\u0435\u0447\u0435\u0438\u0441\u043A\u0430\u043D\u0438\u0435\xBB (\u041F\u0412\u0422)",value:"pvt"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u041C\u0430\u0433\u043D\u0438\u0442\u043D\u044B\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u041C\u041A)",value:"mk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0423\u043B\u044C\u0442\u0440\u0430\u0437\u0432\u0443\u043A\u043E\u0432\u043E\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0423\u041A)",value:"uk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0420\u0430\u0434\u0438\u043E\u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0420\u041A)",value:"rk"}],programOptionsRI:[{label:"\xAB\u041C\u0435\u0445\u0430\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u0435 \u0438\u0441\u043F\u044B\u0442\u0430\u043D\u0438\u044F \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u043E\u0432\xBB (\u041C\u0418)",value:"mi"}],statusOptions:["\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443","\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443","\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443","\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435","\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430","\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"]}}},Be={class:"row q-col-gutter-sm"},Qe={key:0,class:"col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4"},He={key:1,class:"col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4"},ze={key:2,class:"col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4"},Ge={class:"row items-center justify-end"},je={key:3,class:"col-12"},Ke={class:"col-12"},Ze={class:"col-12"},We={class:"col-12"},Xe={class:"col-12 col-xs-12 col-sm-12 col-md-12 col-lg-12"},Je={class:"row q-col-gutter-sm"},Ye={class:"col-12"};function $e(e,o,r,a,M,I){const u=j("ListenersForm"),c=j("UsersForm"),U=j("app-modal");return i(),O("div",null,[d(Ie,{onSubmit:F(a.onSubmit,["prevent","stop"]),class:"q-gutter-md"},{default:m(()=>{var L;return[h("div",Be,[a.access?(i(),O("div",Qe,[d(P,{square:"",modelValue:a.status,"onUpdate:modelValue":o[0]||(o[0]=n=>a.status=n),options:a.statusOptions,label:"\u0421\u0442\u0430\u0442\u0443\u0441",dense:""},null,8,["modelValue","options"])])):g("",!0),a.access?(i(),O("div",He,[d(R,{modelValue:a.contractNumber,"onUpdate:modelValue":o[1]||(o[1]=n=>a.contractNumber=n),modelModifiers:{trim:!0},label:"\u041D\u043E\u043C\u0435\u0440 \u0434\u043E\u0433\u043E\u0432\u043E\u0440\u0430",dense:""},null,8,["modelValue"])])):g("",!0),a.access?(i(),O("div",ze,[d(R,{label:"\u0414\u0430\u0442\u0430 \u0434\u043E\u0433\u043E\u0432\u043E\u0440\u0430",modelValue:a.contractDate,"onUpdate:modelValue":o[3]||(o[3]=n=>a.contractDate=n),mask:"date",dense:""},{append:m(()=>[d(Ce,{name:"event",class:"cursor-pointer"},{default:m(()=>[d(Re,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:m(()=>[d(Fe,{modelValue:a.contractDate,"onUpdate:modelValue":o[2]||(o[2]=n=>a.contractDate=n)},{default:m(()=>[h("div",Ge,[Te(d(w,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[be]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):g("",!0),a.access?(i(),O("div",je,[d(P,{modelValue:a.usersSelect,"onUpdate:modelValue":o[7]||(o[7]=n=>a.usersSelect=n),ref:"usersSelectRef","use-input":"","input-debounce":"0",label:"\u041F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435",options:a.usersSelectOptions,onFilter:a.usersSelectFilterFn,behavior:"menu",error:!!a.usersSelectError,"error-message":a.usersSelectError,"options-dense":"",dense:""},{option:m(n=>[d(K,Ve(Ue(n.itemProps)),{default:m(()=>[d(Z,null,{default:m(()=>[d(te,null,{default:m(()=>[q(oe(n.opt.label),1)]),_:2},1024),d(te,{caption:""},{default:m(()=>[q(oe(n.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":m(()=>[d(K,null,{default:m(()=>[d(Z,{class:"text-grey"},{default:m(()=>[q("\u041F\u043E \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0435\u0442 \u0441\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439")]),_:1}),h("div",null,[d(w,{icon:"add_home_work",type:"button",color:"primary",onClick:o[4]||(o[4]=n=>a.showModal("addCompany"))})])]),_:1})]),append:m(()=>[a.usersSelect?(i(),v(w,{key:0,round:"",dense:"",flat:"",icon:"mode_edit",onClick:o[5]||(o[5]=F(n=>a.showModal("editCompany"),["stop","prevent"]))})):(i(),v(w,{key:1,round:"",dense:"",flat:"",icon:"add_home_work",onClick:o[6]||(o[6]=F(n=>a.showModal("addCompany"),["stop","prevent"]))}))]),_:1},8,["modelValue","options","onFilter","error","error-message"])])):g("",!0),h("div",Ke,[a.access||!a.access&&r.orderData&&r.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&a.commentUser?(i(),v(R,{key:0,square:"",filled:"",autogrow:"",readonly:!a.access,type:"textarea",modelValue:a.commentUser,"onUpdate:modelValue":o[8]||(o[8]=n=>a.commentUser=n),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u0434\u0430\u043D\u043D\u044B\u0445 \u043E \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0438",dense:""},null,8,["readonly","modelValue"])):g("",!0)]),h("div",Ze,[d(P,{label:"\u0421\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044C",square:"","use-input":"","input-debounce":"0",modelValue:a.listenersSelect,"onUpdate:modelValue":o[12]||(o[12]=n=>a.listenersSelect=n),ref:"listenerSelectRef",options:a.listenerOptions,error:!!a.listenersSelectError,"error-message":a.listenersSelectError,onFilter:a.filterFn,onFilterAbort:a.abortFilterFn,"options-dense":"",dense:""},{"no-option":m(()=>[d(K,null,{default:m(()=>[d(Z,{class:"text-grey"},{default:m(()=>[q("\u041F\u043E \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0435\u0442 \u0441\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439")]),_:1}),h("div",null,[d(w,{icon:"person_add",type:"button",color:"primary",onClick:o[9]||(o[9]=n=>a.showModal("addListener"))})])]),_:1})]),append:m(()=>[a.listenersSelect?(i(),v(w,{key:0,round:"",dense:"",flat:"",icon:"mode_edit",onClick:o[10]||(o[10]=F(n=>a.showModal("editListener"),["stop","prevent"]))})):(i(),v(w,{key:1,round:"",dense:"",flat:"",icon:"person_add",onClick:o[11]||(o[11]=F(n=>a.showModal("addListener"),["stop","prevent"]))}))]),_:1},8,["modelValue","options","error","error-message","onFilter","onFilterAbort"])]),h("div",We,[a.access||!a.access&&r.orderData&&r.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&a.commentListener?(i(),v(R,{key:0,square:"",filled:"",autogrow:"",readonly:!a.access,type:"textarea",modelValue:a.commentListener,"onUpdate:modelValue":o[13]||(o[13]=n=>a.commentListener=n),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u0434\u0430\u043D\u043D\u044B\u0445 \u043E \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u0435",dense:""},null,8,["readonly","modelValue"])):g("",!0)]),h("div",Xe,[d(P,{square:"",modelValue:a.program,"onUpdate:modelValue":o[14]||(o[14]=n=>a.program=n),options:r.orderType=="nk"?a.programOptionsNK:a.programOptionsRI,label:"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430 \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u044F \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438","emit-value":"","map-options":"",error:!!a.programError,"error-message":a.programError,"options-dense":"",dense:""},null,8,["modelValue","options","error","error-message"])])]),h("div",Je,[h("div",Ye,[a.access||!a.access&&r.orderData&&r.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&a.commentOrder?(i(),v(R,{key:0,square:"",filled:"",autogrow:"",readonly:!a.access,type:"textarea",modelValue:a.commentOrder,"onUpdate:modelValue":o[15]||(o[15]=n=>a.commentOrder=n),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u0437\u0430\u044F\u0432\u043A\u0438",dense:""},null,8,["readonly","modelValue"])):g("",!0)])]),h("div",null,[r.orderData&&a.access||r.orderData&&!a.access&&r.orderData.status=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||r.orderData&&!a.access&&(r.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"||r.orderData.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")?(i(),v(w,{key:0,label:!a.access&&r.orderData.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?"\u0412 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0438":"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:a.update,color:"primary",class:"q-mr-md"},null,8,["label","onClick"])):g("",!0),r.orderData?g("",!0):(i(),v(w,{key:1,label:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",type:"submit",color:"primary",class:"q-mr-md"})),r.orderData&&a.access&&r.orderData.status!=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"&&r.orderData.status!=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"&&r.orderData.status!=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"||!a.access&&((L=r.orderData)==null?void 0:L.status)=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?(i(),v(w,{key:2,label:"\u041E\u0442\u043C\u0435\u043D\u0430",onClick:o[16]||(o[16]=n=>e.$emit("hide")),color:"primary"})):!r.orderData||r.orderData.status=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||r.orderData&&!a.access&&r.orderData.status!=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||r.orderData&&a.access&&(r.orderData.status=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"||r.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443")?(i(),v(w,{key:3,label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",to:"/orders-training-nk"})):g("",!0)])]}),_:1},8,["onSubmit"]),(i(),v(_e,{to:"body"},[d(U,{title:a.modalTitle,show:a.modal&&!a.loading,fullSize:"",onClose:a.closeModal},{default:m(()=>[a.modalType=="addListener"?(i(),v(u,{key:0,buttonTitle:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",submitType:"add",company:a.usersSelect,onSuccess:a.updateListeners,onHide:a.closeModal},null,8,["company","onSuccess","onHide"])):a.modalType=="editListener"?(i(),v(u,{key:1,buttonTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",submitType:"update",listener:a.currentListener,onSuccess:a.updateListeners,onHide:a.closeModal},null,8,["listener","onSuccess","onHide"])):g("",!0),a.modalType=="addCompany"?(i(),v(c,{key:2,buttonTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",submitType:"register",onSuccess:a.updateUsers},null,8,["onSuccess"])):a.modalType=="editCompany"?(i(),v(c,{key:3,buttonTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",submitType:"update",user:a.currentCompany,onSuccess:a.updateUsers},null,8,["user","onSuccess"])):g("",!0)]),_:1},8,["title","show","onClose"])]))])}var na=ke(Ee,[["render",$e]]);export{na as O};
