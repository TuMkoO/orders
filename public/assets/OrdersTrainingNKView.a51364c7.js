import{_ as Q,a as B,r as f,B as A,o as L,br as I,$ as k,g as c,d as u,e as n,f as s,j as N,w as l,O as h,i as S,ar as y,Q as j,W as x,X as v,bs as E,as as H,at as K,au as R,u as z,Z as G,Y as W}from"./index.5e7d2dce.js";import{Q as M}from"./ClosePopup.10e5cc9b.js";import{A as X,Q as p,a as Y}from"./AppModal.354a324b.js";import{Q as C,a as Z}from"./QFab.73bd0b4f.js";import"./use-checkbox.cc51f2cc.js";import"./QCard.7152ceed.js";const J=[{name:"name",required:!0,label:"\u0424\u0418\u041E",align:"left",field:t=>t.listener.firstName+" "+t.listener.secondName[0]+". "+t.listener.lastName[0]+".",format:t=>`${t}`,sortable:!0},{name:"date",align:"left",label:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",field:"date",sortable:!0},{name:"companyShortName",align:"left",label:"\u041F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435",field:"companyShortName",sortable:!0},{name:"contract",align:"left",label:"\u0414\u043E\u0433\u043E\u0432\u043E\u0440",field:"contractNumber",sortable:!1},{name:"program",align:"left",label:"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430",field:"program",sortable:!0},{name:"status",align:"left",label:"\u0421\u0442\u0430\u0442\u0443\u0441",field:"status",sortable:!0},{name:"control",align:"center",label:"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",field:""}],$=[{name:"name",required:!0,label:"\u0424\u0418\u041E",align:"left",field:t=>t.listener.firstName+" "+t.listener.secondName+" "+t.listener.lastName,format:t=>`${t}`,sortable:!0},{name:"date",align:"left",label:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",field:"date",sortable:!0},{name:"program",align:"left",label:"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430",field:"program",sortable:!0},{name:"status",align:"left",label:"\u0421\u0442\u0430\u0442\u0443\u0441",field:"status",sortable:!0},{name:"control",align:"center",label:"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435",field:""}],ee={components:{AppModal:X},setup(){const t=B(),o=f(!1),r=t.getters["auth/user"],e=f(""),q=A(()=>t.getters["orderTraining/orders"]),_=f([]),g=A(()=>t.getters["orderTraining/orders"].filter(m=>e.value?(m.listener.firstName+" "+m.listener.secondName+" "+m.listener.lastName).toLowerCase().includes(e.value.toLowerCase()):!0)),a=f(!1),i=f(""),w=f("");L(()=>{r.roles&&(r.roles.includes("admin")||r.roles.includes("god")?o.value=!0:o.value=!1)});async function V(){r.roles&&(r.roles.includes("admin")||r.roles.includes("god")?await t.dispatch("orderTraining/load"):await t.dispatch("orderTraining/loadByCompany",r.id))}function D(m,d){a.value=!0,m=="delete"?(i.value="delete",w.value="\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0437\u0430\u044F\u0432\u043A\u0438"):m=="send"&&(i.value="send",w.value="\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443")}function T(){a.value=!1,i.value="",w.value=""}async function F(m){try{await m.forEach(d=>{const P=d._id,U={type:d.orderType,program:d.program,status:"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443",date:new Date,listener:d.listener,company:d.company,ownerCompany:d.ownerCompany,ownerListener:d.ownerListener};t.dispatch("orderTraining/update",{value:U,id:P})})}catch{}T(),V(),_.value=[]}async function O(m){T();for(const d of m)await t.dispatch("orderTraining/remove",d._id);await V(),_.value=[]}return{initialPagination:{sortBy:"status",descending:!0,page:1,rowsPerPage:10},user:r,access:o,columnsAdmin:J,columnsUser:$,rows:q,filteredRows:g,selected:_,search:e,getSelectedString(){return _.value.length===0?"":`${_.value.length} record${_.value.length>1?"s":""} selected of ${g.value.length}`},modal:a,modalType:i,modalTitle:w,showModal:D,closeModal:T,sendForVerification:F,remove:O,dateFormat:I}}},b=t=>(K("data-v-4c57eba6"),t=t(),R(),t),ae={key:0},te=b(()=>n("p",{class:"text-center"}," \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u043E\u043D\u043D\u0430\u044F \u043A\u0430\u0440\u0442\u043E\u0447\u043A\u0430 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u044F \u043D\u0435 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0430! ",-1)),oe={class:"text-center"},ne={key:1},se=b(()=>n("p",{class:"text-center"},"\u0417\u0430\u044F\u0432\u043E\u043A \u043D\u0430 \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u0435 \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438 \u041D\u041A \u043D\u0435\u0442",-1)),le={class:"text-center"},re={key:2},ce={class:""},de={class:"text-responsive"},ie={class:"text-responsive"},me={class:"table-nav"},ue={key:0,class:"q-card__section q-card__section--vert"},_e={key:1,class:"q-card__section q-card__section--vert"},be={class:"q-card__actions justify-end q-card__actions--horiz row"},fe=b(()=>n("span",{class:"q-focus-helper"},null,-1)),ge=b(()=>n("span",{class:"q-btn__content text-center col items-center q-anchor--skip justify-center row"},[n("span",{class:"block"},"\u0423\u0434\u0430\u043B\u0438\u0442\u044C")],-1)),ye=[fe,ge],pe=b(()=>n("span",{class:"q-focus-helper"},null,-1)),ve=b(()=>n("span",{class:"q-btn__content text-center col items-center q-anchor--skip justify-center row"},[n("span",{class:"block"},"\u0414\u0430")],-1)),he=[pe,ve],we=b(()=>n("span",{class:"q-focus-helper"},null,-1)),ke=b(()=>n("span",{class:"q-btn__content text-center col items-center q-anchor--skip justify-center row"},[n("span",{class:"block"},"\u041E\u0442\u043C\u0435\u043D\u0430")],-1)),qe=[we,ke];function Te(t,o,r,e,q,_){const g=k("app-modal");return c(),u("div",null,[!e.access&&(!e.user.id||!e.user.firstName||!e.user.secondName||!e.user.lastName||!e.user.phone||!e.user.email||!e.user.post||!e.user.companyBank||!e.user.companyBik||!e.user.companyDirFirstName||!e.user.companyDirLastName||!e.user.companyDirPost||!e.user.companyDirSecondName||!e.user.companyEmail||!e.user.companyFullName||!e.user.companyGrounds||!e.user.companyInn||!e.user.companyLegalAddressCity||!e.user.companyLegalAddressCode||!e.user.companyLegalAddressHouse||!e.user.companyLegalAddressStreet||!e.user.companyMailAddressCity||!e.user.companyMailAddressCode||!e.user.companyMailAddressHouse||!e.user.companyMailAddressStreet||!e.user.companyOwnershipType||!e.user.companyPayment||!e.user.companyPhone||!e.user.companyShortName)?(c(),u("div",ae,[te,n("div",oe,[s(N,{label:"\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u044C",type:"button",color:"primary",to:"/profile"})])])):e.rows.length?(c(),u("div",re,[n("div",ce,[s(j,{"bottom-slots":"",modelValue:e.search,"onUpdate:modelValue":o[1]||(o[1]=a=>e.search=a),label:"\u0414\u043B\u044F \u0444\u0438\u043B\u044C\u0442\u0440\u0430\u0446\u0438\u0438 \u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0424\u0418\u041E"},{append:l(()=>[e.search!==""?(c(),h(S,{key:0,name:"close",onClick:o[0]||(o[0]=a=>e.search=""),class:"cursor-pointer"})):y("",!0),s(S,{name:"search"})]),_:1},8,["modelValue"])]),s(Y,{rows:e.filteredRows,columns:e.access?e.columnsAdmin:e.columnsUser,"row-key":"_id","selected-rows-label":e.getSelectedString,selection:"multiple",pagination:e.initialPagination,"hide-selected-banner":!0,selected:e.selected,"onUpdate:selected":o[2]||(o[2]=a=>e.selected=a)},{"header-selection":l(a=>[s(M,{modelValue:a.selected,"onUpdate:modelValue":i=>a.selected=i},null,8,["modelValue","onUpdate:modelValue"])]),"body-selection":l(a=>[s(M,{modelValue:a.selected,"onUpdate:modelValue":i=>a.selected=i},null,8,["modelValue","onUpdate:modelValue"])]),"body-cell-date":l(a=>[s(p,{props:a},{default:l(()=>[x(v(e.dateFormat(a.row.date)),1)]),_:2},1032,["props"])]),"body-cell-companyShortName":l(a=>[s(p,{props:a},{default:l(()=>[n("div",de,v(a.row.user.companyShortName),1)]),_:2},1032,["props"])]),"body-cell-contract":l(a=>[s(p,{props:a},{default:l(()=>[x(v(a.row.contractNumber&&a.row.contractDate?a.row.contractNumber+" \u043E\u0442 "+e.dateFormat(a.row.contractDate):"\u041D\u0435 \u0443\u043A\u0430\u0437\u0430\u043D\u043E"),1)]),_:2},1032,["props"])]),"body-cell-program":l(a=>[s(p,{props:a},{default:l(()=>[n("div",ie,v(a.row.program=="vik"?"\u0412\u0418\u041A":a.row.program=="vd"?"\u0412\u0414":a.row.program=="tk"?"\u0422\u041A":a.row.program=="pvk"?"\u041F\u0412\u041A":a.row.program=="pvt"?"\u041F\u0412\u0422":a.row.program=="mk"?"\u041C\u041A":a.row.program=="uk"?"\u0423\u041A":a.row.program=="rk"?"\u0420\u041A":a.row.program=="mi"?"\u041C\u0418":a.row.program=="1s"?"1\u0421":""),1)]),_:2},1032,["props"])]),"body-cell-status":l(a=>[s(p,{props:a},{default:l(()=>[s(E,{color:a.row.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?"primary":a.row.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"?"orange":a.row.status=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"?"purple":a.row.status=="\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430"?"green":a.row.status=="\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430"?"red":a.row.status=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435"?"teal":a.row.status=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"?"grey":""},{default:l(()=>[x(v(a.row.status),1)]),_:2},1032,["color"])]),_:2},1032,["props"])]),"body-cell-control":l(a=>[s(p,{props:a},{default:l(()=>[n("div",null,[s(N,{class:"bg-primary text-white q-mr-sm",icon:"open_in_new",to:{name:"orderTrainingNK",params:{id:a.row._id}}},null,8,["to"])])]),_:2},1032,["props"])]),_:1},8,["rows","columns","selected-rows-label","pagination","selected"]),n("div",me,[s(Z,{color:"secondary",icon:"more_vert",direction:"up"},{default:l(()=>[s(C,{color:"amber","text-color":"black",icon:"delete",disable:!e.selected.length||e.selected.map(a=>a.status).includes("\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")&&!e.access||e.selected.map(a=>a.status).includes("\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443")&&!e.access||e.selected.map(a=>a.status).includes("\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")&&!e.access||e.selected.map(a=>a.status).includes("\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430")&&!e.access||e.selected.map(a=>a.status).includes("\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430")&&!e.access,onClick:o[3]||(o[3]=a=>e.showModal("delete"))},null,8,["disable"]),e.access?y("",!0):(c(),h(C,{key:0,color:"amber","text-color":"black",disable:!e.selected.length||e.selected.map(a=>a.status).includes("\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")||e.selected.map(a=>a.status).includes("\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443")||e.selected.map(a=>a.status).includes("\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")||e.selected.map(a=>a.status).includes("\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430")||e.selected.map(a=>a.status).includes("\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430"),onClick:o[4]||(o[4]=a=>e.showModal("send")),icon:"send_and_archive"},null,8,["disable"])),s(C,{color:"amber","text-color":"black",icon:"note_add",to:"/add-order-training-nk"})]),_:1})])])):(c(),u("div",ne,[se,n("div",le,[s(N,{label:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",type:"button",color:"primary",to:"/add-order-training-nk"})])])),(c(),h(H,{to:"body"},[s(g,{title:e.modalTitle,show:e.modal,onClose:e.closeModal},{default:l(()=>[e.modalType=="delete"?(c(),u("div",ue," \u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B. \u0412\u044B \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0430\u0435\u0442\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0435? ")):y("",!0),e.modalType=="send"?(c(),u("div",_e," \u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0437\u0430\u044F\u0432\u043A\u0438 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443? ")):y("",!0),n("div",be,[e.modalType=="delete"?(c(),u("button",{key:0,class:"q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-negative q-btn--actionable q-focusable q-hoverable",tabindex:"0",type:"button",onClick:o[5]||(o[5]=a=>e.remove(e.selected))},ye)):y("",!0),e.modalType=="send"?(c(),u("button",{key:1,class:"q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-primary q-btn--actionable q-focusable q-hoverable",tabindex:"0",type:"button",onClick:o[6]||(o[6]=a=>e.sendForVerification(e.selected))},he)):y("",!0),n("button",{class:"q-btn q-btn-item non-selectable no-outline q-btn--flat q-btn--rectangle text-positive q-btn--actionable q-focusable q-hoverable",tabindex:"0",type:"button",onClick:o[7]||(o[7]=(...a)=>e.closeModal&&e.closeModal(...a))},qe)])]),_:1},8,["title","show","onClose"])]))])}var Ne=Q(ee,[["render",Te],["__scopeId","data-v-4c57eba6"]]);const xe={title:"\u041F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u0435 \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438 \u041D\u041A",titleTemplate:t=>`${t} | \u041D\u043E\u0432\u044B\u0435 \u0442\u0435\u0445\u043D\u043E\u043B\u043E\u0433\u0438\u0438`},Ce={setup(){z(xe);const t=f(!1),o=B();o.getters["orderTraining/orders"];const r=o.getters["auth/user"];return L(async()=>{t.value=!0,r.roles.length&&(r.roles.includes("admin")||r.roles.includes("god")?await o.dispatch("orderTraining/load"):await o.dispatch("orderTraining/loadByCompany",r.id)),t.value=!1}),{loading:t}},components:{AppLoader:G,AppPage:W,OrdersTrainingTable:Ne}},Ve={key:0};function Ae(t,o,r,e,q,_){const g=k("AppLoader"),a=k("OrdersTrainingTable"),i=k("app-page");return c(),h(i,{title:"\u0417\u0430\u044F\u0432\u043A\u0438 \u043D\u0430 \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u0435 \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438 \u041D\u041A"},{default:l(()=>[n("div",null,[e.loading?(c(),u("div",Ve,[s(g)])):(c(),h(a,{key:1}))])]),_:1})}var Fe=Q(Ce,[["render",Ae]]);export{Fe as default};
