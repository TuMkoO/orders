import{b as P,C as be}from"./ClosePopup.17760fcc.js";import{_ as we,r as y,a as ke,c as Ne,B as x,br as j,o as Se,D as Me,$ as K,g as i,d as O,f as d,w as c,e as f,ar as g,Q as R,i as Le,aI as Ce,j as h,T as Z,aU as Te,aV as Ve,U as W,V as oe,W as q,X as re,O as v,h as F,as as Ue}from"./index.30cc2a21.js";import{L as _e,Q as Oe,a as Re}from"./ListenersForm.d0cfdcc4.js";import{u as Fe,a as A,e as le,c as X,Q as Ae}from"./array.bbac462d.js";import{A as Ie}from"./AppModal.0b0caff4.js";import{U as Pe}from"./UsersForm.3a7c7cee.js";function ne(e){return{email:e.email,id:e._id,firstName:e.firstName,secondName:e.secondName,lastName:e.lastName,post:e.post,phone:e.phone,companyFullName:e.companyFullName,companyShortName:e.companyShortName,companyOwnershipType:e.companyOwnershipType,companyOwnershipTypeOptions:e.companyOwnershipTypeOptions,companyLegalAddressCode:e.companyLegalAddressCode,companyLegalAddressCity:e.companyLegalAddressCity,companyLegalAddressTownship:e.companyLegalAddressTownship,companyLegalAddressStreet:e.companyLegalAddressStreet,companyLegalAddressHouse:e.companyLegalAddressHouse,companyLegalAddressRoom:e.companyLegalAddressRoom,companyMailAddressCode:e.companyMailAddressCode,companyMailAddressCity:e.companyMailAddressCity,companyMailAddressTownship:e.companyMailAddressTownship,companyMailAddressStreet:e.companyMailAddressStreet,companyMailAddressHouse:e.companyMailAddressHouse,companyMailAddressRoom:e.companyMailAddressRoom,companyPhone:e.companyPhone,companyEmail:e.companyEmail,companyBank:e.companyBank,companyPayment:e.companyPayment,companyInn:e.companyInn,companyOkpo:e.companyOkpo,companyBik:e.companyBik,companyDirFirstName:e.companyDirFirstName,companyDirSecondName:e.companyDirSecondName,companyDirLastName:e.companyDirLastName,companyDirPost:e.companyDirPost,companyGrounds:e.companyGrounds}}function xe(e){return{id:e._id,status:e.status,numberNk:e.numberNk,numberRi:e.numberRi,firstName:e.firstName,secondName:e.secondName,lastName:e.lastName,gender:e.gender,snils:e.snils,post:e.post,birthday:e.birthday,passportSeries:e.passportSeries,passportNumber:e.passportNumber,passportIssued:e.passportIssued,passportDate:e.passportDate,passportCode:e.passportCode,mailCode:e.mailCode,city:e.city,township:e.township,street:e.street,homeNumber:e.homeNumber,apartment:e.apartment,phone:e.phone,email:e.email,education:e.education,institution:e.institution,specialization:e.specialization,diplomSeries:e.diplomSeries,diplomNumber:e.diplomNumber,diplomDate:e.diplomDate,weldingMethodDateRde:e.weldingMethodDateRde,weldingMethodDateSp:e.weldingMethodDateSp,weldingMethodDateSf:e.weldingMethodDateSf,weldingMethodDateMig:e.weldingMethodDateMig,weldingMethodDateMag:e.weldingMethodDateMag,weldingMethodDatePag:e.weldingMethodDatePag,weldingMethodDatePig:e.weldingMethodDatePig,weldingMethodDateVig:e.weldingMethodDateVig,weldingMethodDatePs:e.weldingMethodDatePs,weldingMethodDateGs:e.weldingMethodDateGs,weldingMethodDateNi:e.weldingMethodDateNi,weldingMethodDateZn:e.weldingMethodDateZn,weldingMethodDateNg:e.weldingMethodDateNg,weldingMethodDateE:e.weldingMethodDateE,methodNkDateVik:e.methodNkDateVik,methodNkDateVd:e.methodNkDateVd,methodNkDateTk:e.methodNkDateTk,methodNkDatePvk:e.methodNkDatePvk,methodNkDatePvt:e.methodNkDatePvt,methodNkDateMk:e.methodNkDateMk,methodNkDateUk:e.methodNkDateUk,methodNkDateRk:e.methodNkDateRk,methodNkDateMi:e.methodNkDateMi,methodNkDate1s:e.methodNkDate1s,typeRiDateMsi:e.typeRiDateMsi,typeRiDateMdi:e.typeRiDateMdi,typeRiDateIt:e.typeRiDateIt,typeRiDateIks:e.typeRiDateIks,typeRiDateTi:e.typeRiDateTi,typeRiDateIsm:e.typeRiDateIsm,typeRiDateSe:e.typeRiDateSe,typeRiDateSvi:e.typeRiDateSvi,weldingProductionDate:e.weldingProductionDate,pkInfo:e.pkInfo,attNkInfo:e.attNkInfo,attRiInfo:e.attRiInfo,ownerUser:e.ownerUser}}const qe={components:{AppModal:Ie,ListenersForm:_e,UsersForm:Pe},props:{orderType:{type:String,required:!0},orderData:{type:Object,required:!1}},emits:["updateSuccess","hide"],setup(e,{emit:o}){const l=y(!1),a=ke(),k=Ne(),{handleSubmit:E}=Fe(),u=a.getters["auth/user"],m=y(!1),I=x(()=>{var t;return(t=D.value)!=null&&t.value?m.value?ne(a.getters["auth/users"].filter(s=>s._id==D.value.value)[0]):ne({...u,_id:u.id}):null}),U=x(()=>{var t;return(t=b.value)!=null&&t.value?xe(a.getters["listener/listeners"].filter(s=>s._id==b.value.value)[0]):null}),n=y(!1),C=y(""),T=y(""),_=x(()=>a.getters["auth/users"].map(t=>({value:t._id,description:t.companyShortName,label:t.companyFullName}))),B=y(_.value),Q=y(),H=y(),J=y(),Y=y(),N=y(""),S=y(""),M=y(""),p=y("\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"),V=x(()=>a.getters["listener/listeners"].map(t=>({value:t._id,label:t.firstName+" "+t.secondName+" "+t.lastName+" ("+j(t.birthday)+")"}))),z=y(V.value),$=y(0);Se(async()=>{l.value=!0,u.roles.length&&(u.roles.includes("admin")||u.roles.includes("god")?(m.value=!0,await a.dispatch("auth/loadUsers")):m.value=!1),e.orderData?(m.value?D.value=_.value.map(t=>t).filter(t=>t.value==e.orderData.ownerUser)[0]:(D.value={value:u.id,description:u.companyShortName,label:u.companyFullName},b.value=V.value.map(t=>t).filter(t=>t.value==e.orderData.ownerListener)[0]),ee.value=e.orderData.program,p.value=e.orderData.status,N.value=e.orderData.commentUser,S.value=e.orderData.commentListener,M.value=e.orderData.commentOrder,ae.value=e.orderData.contractNumber,te.value=e.orderData.contractDate):D.value={value:u.id,description:u.companyShortName,label:u.companyFullName},l.value=!1});const{value:D,errorMessage:se}=A("usersSelect",le().required("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0443\u043A\u0430\u0436\u0438\u0442\u0435 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435").nullable()),{value:b,errorMessage:de}=A("listenersSelect",le().required("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044F").nullable()),{value:ee,errorMessage:ie}=A("program",X().required("\u041F\u043E\u0436\u0430\u043B\u0443\u0439\u0441\u0442\u0430, \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u043F\u0440\u043E\u0444\u0435\u0441\u0441\u0438\u043E\u043D\u0430\u043B\u044C\u043D\u043E\u0439 \u043F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u044B \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u044F \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438")),{value:ae,errorMessage:me}=A("contractNumber",X().trim()),{value:te,errorMessage:ce}=A("contractDate",X().trim().nullable());Me(D,async(t,s)=>{t!==""&&t!==null?await a.dispatch("listener/loadByCompany",t.value):a.commit("listener/setListeners",[]),e.orderData&&($.value+=1),t!==s&&($.value==1&&e.orderData?b.value=V.value.map(r=>r).filter(r=>r.value==e.orderData.ownerListener)[0]:b.value=void 0)});function ue(t,s){s(()=>{if(t===""){s(()=>{B.value=_.value});return}else{const r=t.toLowerCase();B.value=_.value.filter(L=>L.label.toLowerCase().indexOf(r)>-1||L.description.toLowerCase().indexOf(r)>-1)}})}function pe(t,s,r){s(()=>{if(t===""){s(()=>{z.value=V.value});return}else{const L=t.toLowerCase();z.value=V.value.filter(w=>w.label.toLowerCase().indexOf(L)>-1)}})}function ye(){}const ve=async t=>{if(Q.value.hidePopup(),Q.value.updateInputValue("",!0),m.value&&(H.value.hidePopup(),H.value.updateInputValue("",!0)),n.value=!0,t=="addListener")C.value="addListener",T.value="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u043E\u0433\u043E \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044F";else if(t=="editListener"){C.value="editListener",T.value="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044F";try{l.value=!0,J.value=await a.dispatch("listener/loadById",b.value.value),l.value=!1}catch{l.value=!1}}else if(t=="addCompany")C.value="addCompany",T.value="\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043D\u043E\u0432\u043E\u0435 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435";else if(t=="editCompany"){C.value="editCompany",T.value="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0434\u0430\u043D\u043D\u044B\u0435 \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u044F";try{l.value=!0,await a.dispatch("settingsConfigurable/load","ownership-type"),Y.value=await a.dispatch("auth/loadUserById",D.value.value),l.value=!1}catch{l.value=!1}}},G=()=>{n.value=!1,C.value="",T.value=""},ge=async t=>{u.roles&&(u.roles.includes("admin")||u.roles.includes("god")?D.value?await a.dispatch("listener/loadByCompany",D.value.value):a.commit("listener/setListeners",[]):await a.dispatch("listener/loadByCompany",u.id)),G();const s=V.value.map(r=>r).filter(r=>t.id?r.value==t.id:r.label==t.firstName+" "+t.secondName+" "+t.lastName+" ("+j(t.birthday)+")")[0];b.value=s},De=async t=>{await a.dispatch("auth/loadUsers"),G();const s=_.value.map(r=>r).filter(r=>t.id?r.value==t.id:r.label==t.fullName)[0];D.value=s},fe=E(async t=>{try{await a.dispatch("orderTraining/create",{type:e.orderType,program:t.program,status:p.value,commentUser:N.value,commentListener:S.value,commentOrder:M.value,contractNumber:t.contractNumber,contractDate:t.contractDate,listener:U.value,user:I.value,ownerListener:t.listenersSelect.value,ownerUser:t.usersSelect.value}),k.push("/orders-training-nk")}catch{}}),he=E(async t=>{var L;const s=e.orderData._id,r={type:e.orderType,program:t.program,status:p.value,number:"",commentUser:N.value,commentListener:S.value,commentOrder:M.value,contractNumber:t.contractNumber,contractDate:t.contractDate,date:new Date,listener:U.value,user:I.value,ownerListener:t.listenersSelect.value,ownerUser:t.usersSelect.value};try{if(m.value&&p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&!N.value&&!S.value&&!M.value)a.dispatch("setMessage",{value:"\u041D\u0435\u043E\u0431\u0445\u043E\u0434\u0438\u043C\u043E \u0434\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0445\u043E\u0442\u044F \u0431\u044B \u043E\u0434\u0438\u043D \u043A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439",type:"danger"});else if(m.value&&p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&(N.value||S.value||M.value))await a.dispatch("orderTraining/update",{value:r,id:s}),k.push("/orders-training-nk");else if(m.value&&p.value=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435"&&(N.value||S.value||M.value))a.dispatch("setMessage",{value:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u043D\u0430\u0447\u0430\u0442\u044C \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435, \u043D\u0435 \u0443\u0441\u0442\u0440\u0430\u043D\u0435\u043D\u044B \u0432\u0441\u0435 \u0437\u0430\u043C\u0435\u0447\u0430\u043D\u0438\u044F",type:"danger"});else if(m.value&&p.value=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")r.commentUser="",r.commentListener="",r.commentOrder="",await a.dispatch("orderTraining/update",{value:r,id:s}),o("updateSuccess");else if(m.value&&p.value=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435"){if(((L=e==null?void 0:e.orderData)==null?void 0:L.status)=="\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")r.number=e.orderData.number;else{await a.dispatch("orderTrainingNumbering/load");const w=a.getters["orderTrainingNumbering/ordersNumbering"][0];r.number=w.prefix+w.num,await a.dispatch("orderTrainingNumbering/update",{prefix:w.prefix,num:+w.num+1,id:w._id})}r.date=new Date,await a.dispatch("orderTraining/update",{value:r,id:s}),o("updateSuccess")}else m.value&&p.value=="\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430"?(r.number=e.orderData.number,r.date=new Date,await a.dispatch("orderTraining/update",{value:r,id:s}),o("updateSuccess")):!m.value&&p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"?(await a.dispatch("orderTraining/update",{value:r,id:s}),k.push("/orders-training-nk")):!m.value&&p.value=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?(r.status="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A",await a.dispatch("orderTraining/update",{value:r,id:s}),k.push("/orders-training-nk")):m.value&&p.value=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"?(r.commentUser="",r.commentListener="",r.commentOrder="",await a.dispatch("orderTraining/update",{value:r,id:s}),k.push("/orders-training-nk")):!m.value&&p.value=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||m.value&&(p.value=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"||p.value=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"||p.value=="\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430")?(await a.dispatch("orderTraining/update",{value:r,id:s}),k.push("/orders-training-nk")):(await a.dispatch("orderTraining/update",{value:r,id:s}),o("updateSuccess"))}catch{}});return{access:m,loading:l,modal:n,modalType:C,modalTitle:T,currentListener:J,currentCompany:Y,showModal:ve,closeModal:G,onSubmit:fe,update:he,updateListeners:ge,updateUsers:De,dateFormat:j,usersSelectOptions:B,usersSelectFilterFn:ue,usersSelect:D,usersSelectError:se,listenersSelect:b,listenersSelectError:de,contractNumber:ae,contractDate:te,cNumberError:me,cDateError:ce,commentUser:N,commentListener:S,commentOrder:M,filterFn:pe,abortFilterFn:ye,program:ee,programError:ie,status:p,listenerOptions:z,listenerSelectRef:Q,usersSelectRef:H,programOptionsNK:[{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0412\u0438\u0437\u0443\u0430\u043B\u044C\u043D\u044B\u0439 \u0438 \u0438\u0437\u043C\u0435\u0440\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0412\u0418\u041A)",value:"vik"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u044F \xAB\u0412\u0438\u0431\u0440\u043E\u0434\u0438\u0430\u0433\u043D\u043E\u0441\u0442\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0412\u0414)",value:"vd"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u0441\u043E\u0441\u0442\u043E\u044F\u043D\u0438\u044F \xAB\u0422\u0435\u043F\u043B\u043E\u0432\u043E\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0422\u041A)",value:"tk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u041A\u0430\u043F\u0438\u043B\u043B\u044F\u0440\u043D\u044B\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u041F\u0412\u041A)",value:"pvk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0422\u0435\u0447\u0435\u0438\u0441\u043A\u0430\u043D\u0438\u0435\xBB (\u041F\u0412\u0422)",value:"pvt"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u041C\u0430\u0433\u043D\u0438\u0442\u043D\u044B\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u041C\u041A)",value:"mk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0423\u043B\u044C\u0442\u0440\u0430\u0437\u0432\u0443\u043A\u043E\u0432\u043E\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0423\u041A)",value:"uk"},{label:"\u041D\u0435\u0440\u0430\u0437\u0440\u0443\u0448\u0430\u044E\u0449\u0438\u0439 \u043C\u0435\u0442\u043E\u0434 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044F \u043A\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \xAB\u0420\u0430\u0434\u0438\u043E\u0433\u0440\u0430\u0444\u0438\u0447\u0435\u0441\u043A\u0438\u0439 \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u044C\xBB (\u0420\u041A)",value:"rk"}],programOptionsRI:[{label:"\xAB\u041C\u0435\u0445\u0430\u043D\u0438\u0447\u0435\u0441\u043A\u0438\u0435 \u0438\u0441\u043F\u044B\u0442\u0430\u043D\u0438\u044F \u043C\u0430\u0442\u0435\u0440\u0438\u0430\u043B\u043E\u0432\xBB (\u041C\u0418)",value:"mi"}],statusOptions:["\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443","\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443","\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443","\u0418\u0434\u0451\u0442 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u0435","\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u0430","\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"]}}},Ee={class:"row q-col-gutter-sm"},Be={key:0,class:"col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4"},Qe={key:1,class:"col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4"},He={key:2,class:"col-12 col-xs-12 col-sm-4 col-md-4 col-lg-4"},ze={class:"row items-center justify-end"},Ge={key:3,class:"col-12"},je={class:"col-12"},Ke={class:"col-12"},Ze={class:"col-12"},We={class:"col-12 col-xs-12 col-sm-12 col-md-12 col-lg-12"},Xe={class:"row q-col-gutter-sm"},Je={class:"col-12"};function Ye(e,o,l,a,k,E){const u=K("ListenersForm"),m=K("UsersForm"),I=K("app-modal");return i(),O("div",null,[d(Ae,{onSubmit:F(a.onSubmit,["prevent","stop"]),class:"q-gutter-md"},{default:c(()=>{var U;return[f("div",Ee,[a.access?(i(),O("div",Be,[d(P,{square:"",modelValue:a.status,"onUpdate:modelValue":o[0]||(o[0]=n=>a.status=n),options:a.statusOptions,label:"\u0421\u0442\u0430\u0442\u0443\u0441",dense:""},null,8,["modelValue","options"])])):g("",!0),a.access?(i(),O("div",Qe,[d(R,{modelValue:a.contractNumber,"onUpdate:modelValue":o[1]||(o[1]=n=>a.contractNumber=n),modelModifiers:{trim:!0},label:"\u041D\u043E\u043C\u0435\u0440 \u0434\u043E\u0433\u043E\u0432\u043E\u0440\u0430",dense:""},null,8,["modelValue"])])):g("",!0),a.access?(i(),O("div",He,[d(R,{label:"\u0414\u0430\u0442\u0430 \u0434\u043E\u0433\u043E\u0432\u043E\u0440\u0430",modelValue:a.contractDate,"onUpdate:modelValue":o[3]||(o[3]=n=>a.contractDate=n),mask:"date",dense:""},{append:c(()=>[d(Le,{name:"event",class:"cursor-pointer"},{default:c(()=>[d(Oe,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:c(()=>[d(Re,{modelValue:a.contractDate,"onUpdate:modelValue":o[2]||(o[2]=n=>a.contractDate=n)},{default:c(()=>[f("div",ze,[Ce(d(h,{label:"\u0417\u0430\u043A\u0440\u044B\u0442\u044C",color:"primary",flat:""},null,512),[[be]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])):g("",!0),a.access?(i(),O("div",Ge,[d(P,{modelValue:a.usersSelect,"onUpdate:modelValue":o[7]||(o[7]=n=>a.usersSelect=n),ref:"usersSelectRef","use-input":"","input-debounce":"0",label:"\u041F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0435",options:a.usersSelectOptions,onFilter:a.usersSelectFilterFn,behavior:"menu",error:!!a.usersSelectError,"error-message":a.usersSelectError,"options-dense":"",dense:""},{option:c(n=>[d(Z,Te(Ve(n.itemProps)),{default:c(()=>[d(W,null,{default:c(()=>[d(oe,null,{default:c(()=>[q(re(n.opt.label),1)]),_:2},1024),d(oe,{caption:""},{default:c(()=>[q(re(n.opt.description),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),"no-option":c(()=>[d(Z,null,{default:c(()=>[d(W,{class:"text-grey"},{default:c(()=>[q("\u041F\u043E \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0435\u0442 \u0441\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439")]),_:1}),f("div",null,[d(h,{icon:"add_home_work",type:"button",color:"primary",onClick:o[4]||(o[4]=n=>a.showModal("addCompany"))})])]),_:1})]),append:c(()=>[a.usersSelect?(i(),v(h,{key:0,round:"",dense:"",flat:"",icon:"mode_edit",onClick:o[5]||(o[5]=F(n=>a.showModal("editCompany"),["stop","prevent"]))})):(i(),v(h,{key:1,round:"",dense:"",flat:"",icon:"add_home_work",onClick:o[6]||(o[6]=F(n=>a.showModal("addCompany"),["stop","prevent"]))}))]),_:1},8,["modelValue","options","onFilter","error","error-message"])])):g("",!0),f("div",je,[a.access||!a.access&&l.orderData&&l.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&a.commentUser?(i(),v(R,{key:0,square:"",filled:"",autogrow:"",readonly:!a.access,type:"textarea",modelValue:a.commentUser,"onUpdate:modelValue":o[8]||(o[8]=n=>a.commentUser=n),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u0434\u0430\u043D\u043D\u044B\u0445 \u043E \u043F\u0440\u0435\u0434\u043F\u0440\u0438\u044F\u0442\u0438\u0438",dense:""},null,8,["readonly","modelValue"])):g("",!0)]),f("div",Ke,[d(P,{label:"\u0421\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u044C",square:"","use-input":"","input-debounce":"0",modelValue:a.listenersSelect,"onUpdate:modelValue":o[12]||(o[12]=n=>a.listenersSelect=n),ref:"listenerSelectRef",options:a.listenerOptions,error:!!a.listenersSelectError,"error-message":a.listenersSelectError,onFilter:a.filterFn,onFilterAbort:a.abortFilterFn,"options-dense":"",dense:""},{"no-option":c(()=>[d(Z,null,{default:c(()=>[d(W,{class:"text-grey"},{default:c(()=>[q("\u041F\u043E \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0435\u0442 \u0441\u043E\u0432\u043F\u0430\u0434\u0435\u043D\u0438\u0439")]),_:1}),f("div",null,[d(h,{icon:"person_add",type:"button",color:"primary",onClick:o[9]||(o[9]=n=>a.showModal("addListener"))})])]),_:1})]),append:c(()=>[a.listenersSelect?(i(),v(h,{key:0,round:"",dense:"",flat:"",icon:"mode_edit",onClick:o[10]||(o[10]=F(n=>a.showModal("editListener"),["stop","prevent"]))})):(i(),v(h,{key:1,round:"",dense:"",flat:"",icon:"person_add",onClick:o[11]||(o[11]=F(n=>a.showModal("addListener"),["stop","prevent"]))}))]),_:1},8,["modelValue","options","error","error-message","onFilter","onFilterAbort"])]),f("div",Ze,[a.access||!a.access&&l.orderData&&l.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&a.commentListener?(i(),v(R,{key:0,square:"",filled:"",autogrow:"",readonly:!a.access,type:"textarea",modelValue:a.commentListener,"onUpdate:modelValue":o[13]||(o[13]=n=>a.commentListener=n),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u0434\u0430\u043D\u043D\u044B\u0445 \u043E \u0441\u043B\u0443\u0448\u0430\u0442\u0435\u043B\u0435",dense:""},null,8,["readonly","modelValue"])):g("",!0)]),f("div",We,[d(P,{square:"",modelValue:a.program,"onUpdate:modelValue":o[14]||(o[14]=n=>a.program=n),options:l.orderType=="nk"?a.programOptionsNK:a.programOptionsRI,label:"\u041F\u0440\u043E\u0433\u0440\u0430\u043C\u043C\u0430 \u043F\u043E\u0432\u044B\u0448\u0435\u043D\u0438\u044F \u043A\u0432\u0430\u043B\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u0438","emit-value":"","map-options":"",error:!!a.programError,"error-message":a.programError,"options-dense":"",dense:""},null,8,["modelValue","options","error","error-message"])])]),f("div",Xe,[f("div",Je,[a.access||!a.access&&l.orderData&&l.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"&&a.commentOrder?(i(),v(R,{key:0,square:"",filled:"",autogrow:"",readonly:!a.access,type:"textarea",modelValue:a.commentOrder,"onUpdate:modelValue":o[15]||(o[15]=n=>a.commentOrder=n),label:"\u041A\u043E\u043C\u043C\u0435\u043D\u0442\u0430\u0440\u0438\u0439 \u043A \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u044E \u0437\u0430\u044F\u0432\u043A\u0438",dense:""},null,8,["readonly","modelValue"])):g("",!0)])]),f("div",null,[l.orderData&&a.access||l.orderData&&!a.access&&l.orderData.status=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||l.orderData&&!a.access&&(l.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"||l.orderData.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443")?(i(),v(h,{key:0,label:!a.access&&l.orderData.status=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?"\u0412 \u0447\u0435\u0440\u043D\u043E\u0432\u0438\u043A\u0438":"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",onClick:a.update,color:"primary",class:"q-mr-md"},null,8,["label","onClick"])):g("",!0),l.orderData?g("",!0):(i(),v(h,{key:1,label:"\u0421\u043E\u0437\u0434\u0430\u0442\u044C",type:"submit",color:"primary",class:"q-mr-md"})),l.orderData&&a.access&&l.orderData.status!=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"&&l.orderData.status!=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"&&l.orderData.status!=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443"||!a.access&&((U=l.orderData)==null?void 0:U.status)=="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u0432 \u0440\u0430\u0431\u043E\u0442\u0443"?(i(),v(h,{key:2,label:"\u041E\u0442\u043C\u0435\u043D\u0430",onClick:o[16]||(o[16]=n=>e.$emit("hide")),color:"primary"})):!l.orderData||l.orderData.status=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||l.orderData&&!a.access&&l.orderData.status!=="\u0427\u0435\u0440\u043D\u043E\u0432\u0438\u043A"||l.orderData&&a.access&&(l.orderData.status=="\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0430 \u043D\u0430 \u044D\u043A\u0441\u043F\u0435\u0440\u0442\u0438\u0437\u0443"||l.orderData.status=="\u0412\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u0430 \u043D\u0430 \u043A\u043E\u0440\u0440\u0435\u043A\u0442\u0438\u0440\u043E\u0432\u043A\u0443")?(i(),v(h,{key:3,label:"\u041E\u0442\u043C\u0435\u043D\u0430",color:"primary",to:"/orders-training-nk"})):g("",!0)])]}),_:1},8,["onSubmit"]),(i(),v(Ue,{to:"body"},[d(I,{title:a.modalTitle,show:a.modal&&!a.loading,fullSize:"",onClose:a.closeModal},{default:c(()=>[a.modalType=="addListener"?(i(),v(u,{key:0,buttonTitle:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",submitType:"add",company:a.usersSelect,onSuccess:a.updateListeners,onHide:a.closeModal},null,8,["company","onSuccess","onHide"])):a.modalType=="editListener"?(i(),v(u,{key:1,buttonTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",submitType:"update",listener:a.currentListener,onSuccess:a.updateListeners,onHide:a.closeModal},null,8,["listener","onSuccess","onHide"])):g("",!0),a.modalType=="addCompany"?(i(),v(m,{key:2,buttonTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",submitType:"register",onSuccess:a.updateUsers},null,8,["onSuccess"])):a.modalType=="editCompany"?(i(),v(m,{key:3,buttonTitle:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",submitType:"update",user:a.currentCompany,onSuccess:a.updateUsers},null,8,["user","onSuccess"])):g("",!0)]),_:1},8,["title","show","onClose"])]))])}var la=we(qe,[["render",Ye]]);export{la as O};
